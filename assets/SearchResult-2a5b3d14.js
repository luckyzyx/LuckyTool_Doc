import{u as G,b as C,W as M,c as Q,d as _,e as F,n as O,o as T,s as V,l as z,i as I,f as J,g as K,h as w,j as N,H as X,m as Y}from"./app-32ed2397.js";import{c as Z,A as ee,G as ae,r as m,h as q,o as se,E as le,j as e,R as A,w as te,D as ue,i as re}from"./framework-53aeaa0f.js";const ne="search-pro-history-results",n=G(ne,[]),oe=()=>{const{historyCount:o}=w;return{history:n,addHistory:t=>{n.value.length<o?n.value=[t,...n.value]:n.value=[t,...n.value.slice(0,o-1)]},removeHistory:t=>{n.value=[...n.value.slice(0,t),...n.value.slice(t+1)]}}},ce=o=>{const t=C(),i=m(!1),d=m([]);let c;const v=K(p=>{i.value=!0,c==null||c.terminate(),p?(c=new Worker(`/LuckyTool_Doc/${w.worker}`,{}),c.addEventListener("message",({data:g})=>{d.value=g,i.value=!1}),c.postMessage({query:p,routeLocale:t.value})):(d.value=[],i.value=!1)},w.delay);return te([o,t],()=>v(o.value),{immediate:!0}),{searching:i,results:d}};var pe=Z({name:"SearchResult",props:{query:{type:String,required:!0}},emits:{close:()=>!0,updateQuery:o=>!0},setup(o,{emit:t}){const i=N(),d=ee(),c=C(),v=M(X),{history:p,addHistory:g,removeHistory:E}=oe(),k=ae(o,"query"),{results:y,searching:P}=ce(k),u=m(0),l=m(0),S=m(),$=q(()=>y.value.length>0),L=q(()=>y.value[u.value]||null),j=()=>{u.value=u.value>0?u.value-1:y.value.length-1,l.value=L.value.contents.length-1},B=()=>{u.value=u.value<y.value.length-1?u.value+1:0,l.value=0},U=()=>{l.value<L.value.contents.length-1?l.value=l.value+1:B()},W=()=>{l.value>0?l.value=l.value-1:j()},D=a=>a.map(s=>re(s)?s:e(s[0],s[1])),H=a=>{if(a.type==="custom"){const s=Y[a.index]||"$content",[h,f=""]=ue(s)?s[c.value].split("$content"):s.split("$content");return D([h,...a.display,f])}return D(a.display)},R=()=>{u.value=0,l.value=0,t("updateQuery",""),t("close")};return se(()=>{Q("keydown",a=>{if($.value){if(a.key==="ArrowUp")W();else if(a.key==="ArrowDown")U();else if(a.key==="Enter"){const s=L.value.contents[l.value];i.value.path!==s.path&&(g(s),d.push(s.path),R())}}}),_(S.value,{reserveScrollBarGap:!0})}),le(()=>{F()}),()=>e("div",{class:["search-pro-result",{empty:k.value===""?p.value.length===0:!$.value}],ref:S},k.value===""?p.value.length?e("ul",{class:"search-pro-result-list"},e("li",{class:"search-pro-result-list-item"},[e("div",{class:"search-pro-result-title"},v.value.history),p.value.map((a,s)=>e(A,{to:a.path,class:["search-pro-result-item",{active:l.value===s}],onClick:()=>{R()}},()=>[e(O,{class:"search-pro-result-type"}),e("div",{class:"search-pro-result-content"},[a.type==="content"&&a.header?e("div",{class:"content-header"},a.header):null,e("div",H(a))]),e("button",{class:"search-pro-close-icon",onClick:h=>{h.preventDefault(),h.stopPropagation(),E(s)}},e(T))]))])):v.value.emptyHistory:P.value?e(V,{hint:v.value.searching}):$.value?e("ul",{class:"search-pro-result-list"},y.value.map(({title:a,contents:s},h)=>{const f=u.value===h;return e("li",{class:["search-pro-result-list-item",{active:f}]},[e("div",{class:"search-pro-result-title"},a||"Documentation"),s.map((r,x)=>{const b=f&&l.value===x;return e(A,{to:r.path,class:["search-pro-result-item",{active:b,"aria-selected":b}],onClick:()=>{g(r),R()}},()=>[r.type==="content"?null:e(r.type==="title"?z:r.type==="heading"?I:J,{class:"search-pro-result-type"}),e("div",{class:"search-pro-result-content"},[r.type==="content"&&r.header?e("div",{class:"content-header"},r.header):null,e("div",H(r))])])})])})):v.value.emptyResult)}});export{pe as default};
